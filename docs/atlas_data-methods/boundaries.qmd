# Boundary Datasets {#sec-boundaries}

## Administrative Boundaries

The Adaptation Atlas uses
[GAUL 2024](https://data.apps.fao.org/catalog/dataset/60b23906-f21a-49ef-8424-f3645e70264e)
from FAO as the source for all administrative boundaries. GAUL provides a
harmonized, high-resolution global dataset of administrative boundaries. Using
GAUL ensures a consistent framework across countries, simplifies data
aggregation and analysis, and allows datasets to be easily downloaded and
reproduced.

### Raw GAUL Boundaries

The raw GAUL boundaries represent the original FAO administrative boundaries
with minor adjustments to support analysis. GAUL does not provide country-level
(admin 0) boundaries, so both admin 0 and admin 1 boundaries in the Atlas were
created by aggregating the admin 2 boundaries. Before aggregation, major water
bodies included in GAUL were removed from the admin 2 boundaries. Admin 1
boundaries were quality-checked against the official GAUL admin 1 boundaries to
ensure that the aggregation process preserved accuracy. The resulting "raw"
boundaries therefore include:

- Original FAO geometries (admin 2) without major water bodies.

- Aggregated admin 1 and admin 0 boundaries derived from the GAUL 2 geometries.

### Analysis Ready Boundaries

Analysis-ready boundaries extend the raw boundaries to better support data
aggregation and reporting. These boundaries:

Identify disputed regions within the GAUL boundaries and assign them to all
countries that claim them, ensuring that aggregated data matches national
representations.

Include additional attributes to facilitate analysis and linking with other
datasets.

Preserve the same geometries as the raw boundaries, except where overlapping or
unioned boundaries are required to account for disputes.

This approach ensures that the Atlas provides an accurate representation of
FAO's GAUL data while providing countries with data that is representative of
how they represent their boundaries.

### Rasterized Boundaries

In addition to vector boundaries, the Atlas provides rasterized versions of
administrative boundaries for use in zonal extractions. These rasters are
available at all three administrative levels (0, 1, and 2) and use the numeric
GAUL codes as the raster values.

It is important to note that these raster datasets are based on the raw GAUL
boundaries described above and do not account for disputed areas. Overlaps in
boundaries cannot be represented in a raster, so any treatment of disputed
regions must be performed after the zonal extraction. Depending on the type of
data, this can be done using simple summation or a weighted mean. To facilitate
this, the Atlas provides a reference table listing each disputed area, the
countries claiming it, and the area of each region.

### Simplified Boundaries

To ensure efficient rendering while retaining topological accuracy, we applied
multi-resolution boundary simplifications using
[mapshaper](https://mapshaper.org/). These simplified boundaries are based on
the analysis ready boundaries and should be used for visualizations as their
file size is significantly smaller than the analysis ready boundaries. The
script used for simplification can be found
[here](https://github.com/AdaptationAtlas/spatial-foundation/blob/main/simplify_bounds.ts)

#### Boundary Simplification Parameters

**Simplification method:** `Visvalingam / weighted area`\
**Shape preservation:** `Prevent shape removal = true`

| Boundary Level | High Res (%) | Low Res (%) | Very Low Res (%) | Very Very Low Res (%) |
| -------------- | ------------ | ----------- | ---------------- | --------------------- |
| Admin 2        | 20           | 3           | 0.7              | â€“                     |
| Admin 1        | 14           | 4.7         | 1.1              | 0.25                  |
| Admin 0        | 13           | 1.4         | 0.5              | 0.18                  |

## Watershed Boundaries

The Adaptation Atlas uses watershed boundaries from the WMO Basins and
Sub-Basins (WMOBB) dataset, derived from the HydroSHEDS database. This dataset
includes one level of watersheds and is provided in two versions: analysis-ready
and visualization. The dataset incorporates data from HydroSHEDS and other
sources under license.

## Boundary Data Index & Paths

All of the boundary datasets are stored in the Adaptation Atlas S3 bucket and
are cataloged in our STAC. You can also use the below table to filter and
discover the data mentioned above.

```{r}
#| echo: false
library(s3fs)
library(DT)
s3 <- s3fs::S3FileSystem$new(anonymous = TRUE)

ws_bounds <- s3$dir_ls(
  "digital-atlas/domain=boundaries/type=watershed/",
  recurse = T
)

gaul_bounds <- s3$dir_ls(
  "digital-atlas/domain=boundaries/type=admin/source=gaul2024/",
  recurse = T
)

s3_paths <- c(ws_bounds, gaul_bounds)

split_paths <- strsplit(sub("^s3://digital-atlas/", "", s3_paths), "/")

# Extract key=value pairs and filename
df <- do.call(
  rbind,
  lapply(split_paths, function(parts) {
    kv <- parts[grepl("=", parts)]
    keys <- sapply(strsplit(kv, "="), `[`, 1)
    values <- sapply(strsplit(kv, "="), `[`, 2)
    res <- setNames(values, keys)
    res["filename"] <- parts[length(parts)]
    # Ensure all columns exist
    all_cols <- c(
      "domain",
      "type",
      "source",
      "region",
      "processing",
      "level",
      "filename"
    )
    res[setdiff(all_cols, names(res))] <- NA
    res[all_cols]
  })
)

df <- as.data.frame(df, stringsAsFactors = FALSE)
df$s3_path <- s3_paths

# Drop first domain column as all domain = Boundaries
datatable(df[-1], rownames = FALSE)
```
