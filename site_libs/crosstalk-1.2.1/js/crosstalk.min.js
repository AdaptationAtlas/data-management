(function d(p,s,f){function c(o,i){if(!s[o]){if(!p[o]){var t=typeof require=="function"&&require;if(!i&&t)return t(o,!0);if(h)return h(o,!0);var e=new Error("Cannot find module '"+o+"'");throw e.code="MODULE_NOT_FOUND",e}var n=s[o]={exports:{}};p[o][0].call(n.exports,function(r){var a=p[o][1][r];return c(a||r)},n,n.exports,d,p,s,f)}return s[o].exports}for(var h=typeof require=="function"&&require,u=0;u<f.length;u++)c(f[u]);return c})({1:[function(d,p,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var f=function(){function h(u,o){for(var i=0;i<o.length;i++){var t=o[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(u,t.key,t)}}return function(u,o,i){return o&&h(u.prototype,o),i&&h(u,i),u}}(),c=function(){function h(){(function(u,o){if(!(u instanceof o))throw new TypeError("Cannot call a class as a function")})(this,h),this._types={},this._seq=0}return f(h,[{key:"on",value:function(u,o){var i=this._types[u];i||(i=this._types[u]={});var t="sub"+this._seq++;return i[t]=o,t}},{key:"off",value:function(u,o){var i=this._types[u];if(typeof o=="function"){for(var t in i)if(i.hasOwnProperty(t)&&i[t]===o)return delete i[t],t;return!1}if(typeof o=="string")return!(!i||!i[o])&&(delete i[o],o);throw new Error("Unexpected type for listener")}},{key:"trigger",value:function(u,o,i){var t=this._types[u];for(var e in t)t.hasOwnProperty(e)&&t[e].call(i,o)}}]),h}();s.default=c},{}],2:[function(d,p,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.FilterHandle=void 0;var f=function(){function e(n,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(n,l.key,l)}}return function(n,r,a){return r&&e(n.prototype,r),a&&e(n,a),n}}(),c=i(d("./events")),h=i(d("./filterset")),u=i(d("./group")),o=function(e){{if(e&&e.__esModule)return e;var n={};if(e!=null)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n.default=e,n}}(d("./util"));function i(e){return e&&e.__esModule?e:{default:e}}var t=1;s.FilterHandle=function(){function e(n,r){(function(a,l){if(!(a instanceof l))throw new TypeError("Cannot call a class as a function")})(this,e),this._eventRelay=new c.default,this._emitter=new o.SubscriptionTracker(this._eventRelay),this._group=null,this._filterSet=null,this._filterVar=null,this._varOnChangeSub=null,this._extraInfo=o.extend({sender:this},r),this._id="filter"+t++,this.setGroup(n)}return f(e,[{key:"setGroup",value:function(n){var r,a,l=this;if(this._group!==n&&(this._group||n)&&(this._filterVar&&(this._filterVar.off("change",this._varOnChangeSub),this.clear(),this._varOnChangeSub=null,this._filterVar=null,this._filterSet=null),this._group=n)){n=(0,u.default)(n),this._filterSet=(r=n.var("filterset"),(a=r.get())||(a=new h.default,r.set(a)),a),this._filterVar=(0,u.default)(n).var("filter");var v=this._filterVar.on("change",function(y){l._eventRelay.trigger("change",y,l)});this._varOnChangeSub=v}}},{key:"_mergeExtraInfo",value:function(n){return o.extend({},this._extraInfo?this._extraInfo:null,n||null)}},{key:"close",value:function(){this._emitter.removeAllListeners(),this.clear(),this.setGroup(null)}},{key:"clear",value:function(n){this._filterSet&&(this._filterSet.clear(this._id),this._onChange(n))}},{key:"set",value:function(n,r){this._filterSet&&(this._filterSet.update(this._id,n),this._onChange(r))}},{key:"on",value:function(n,r){return this._emitter.on(n,r)}},{key:"off",value:function(n,r){return this._emitter.off(n,r)}},{key:"_onChange",value:function(n){this._filterSet&&this._filterVar.set(this._filterSet.value,this._mergeExtraInfo(n))}},{key:"filteredKeys",get:function(){return this._filterSet?this._filterSet.value:null}}]),e}()},{"./events":1,"./filterset":3,"./group":4,"./util":11}],3:[function(d,p,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var f=function(){function o(i,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}return function(i,t,e){return t&&o(i.prototype,t),e&&o(i,e),i}}(),c=d("./util");function h(o,i){return o===i?0:o<i?-1:i<o?1:void 0}var u=function(){function o(){(function(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")})(this,o),this.reset()}return f(o,[{key:"reset",value:function(){this._handles={},this._keys={},this._value=null,this._activeHandles=0}},{key:"update",value:function(i,t){t!==null&&(t=t.slice(0)).sort(h);var e=(0,c.diffSortedLists)(this._handles[i],t),n=e.added,r=e.removed;this._handles[i]=t;for(var a=0;a<n.length;a++)this._keys[n[a]]=(this._keys[n[a]]||0)+1;for(var l=0;l<r.length;l++)this._keys[r[l]]--;this._updateValue(t)}},{key:"_updateValue",value:function(){var i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this._allKeys,t=Object.keys(this._handles).length;if(t===0)this._value=null;else{this._value=[];for(var e=0;e<i.length;e++)this._keys[i[e]]===t&&this._value.push(i[e])}}},{key:"clear",value:function(i){if(this._handles[i]!==void 0){var t=this._handles[i];t||(t=[]);for(var e=0;e<t.length;e++)this._keys[t[e]]--;delete this._handles[i],this._updateValue()}}},{key:"value",get:function(){return this._value}},{key:"_allKeys",get:function(){var i=Object.keys(this._keys);return i.sort(h),i}}]),o}();s.default=u},{"./util":11}],4:[function(d,p,s){(function(f){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var c=function(){function n(r,a){for(var l=0;l<a.length;l++){var v=a[l];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(r,v.key,v)}}return function(r,a,l){return a&&n(r.prototype,a),l&&n(r,l),r}}(),h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};s.default=function n(r){{if(r&&typeof r=="string")return t.hasOwnProperty(r)||(t[r]=new e(r)),t[r];if((r===void 0?"undefined":h(r))==="object"&&r._vars&&r.var)return r;if(Array.isArray(r)&&r.length==1&&typeof r[0]=="string")return n(r[0]);throw new Error("Invalid groupName argument")}};var u,o=d("./var"),i=(u=o)&&u.__esModule?u:{default:u};f.__crosstalk_groups=f.__crosstalk_groups||{};var t=f.__crosstalk_groups,e=function(){function n(r){(function(a,l){if(!(a instanceof l))throw new TypeError("Cannot call a class as a function")})(this,n),this.name=r,this._vars={}}return c(n,[{key:"var",value:function(r){if(!r||typeof r!="string")throw new Error("Invalid var name");return this._vars.hasOwnProperty(r)||(this._vars[r]=new i.default(this,r)),this._vars[r]}},{key:"has",value:function(r){if(!r||typeof r!="string")throw new Error("Invalid var name");return this._vars.hasOwnProperty(r)}}]),n}()}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./var":12}],5:[function(d,p,s){(function(f){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var c,h=d("./group"),u=(c=h)&&c.__esModule?c:{default:c},o=d("./selection"),i=d("./filter"),t=d("./input");d("./input_selectize"),d("./input_checkboxgroup"),d("./input_slider");var e=(0,u.default)("default");function n(a){return e.var(a)}f.Shiny&&f.Shiny.addCustomMessageHandler("update-client-value",function(a){typeof a.group=="string"?(0,u.default)(a.group).var(a.name).set(a.value):n(a.name).set(a.value)});var r={group:u.default,var:n,has:function(a){return e.has(a)},SelectionHandle:o.SelectionHandle,FilterHandle:i.FilterHandle,bind:t.bind};s.default=r,f.crosstalk=r}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./filter":2,"./group":4,"./input":6,"./input_checkboxgroup":7,"./input_selectize":8,"./input_slider":9,"./selection":10}],6:[function(d,p,s){(function(f){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.register=function(e){h[e.className]=e,f.document&&f.document.readyState!=="complete"?c(function(){u()}):f.document&&setTimeout(u,100)},s.bind=u;var c=f.jQuery,h={};function u(){Object.keys(h).forEach(function(e){var n=h[e];c("."+n.className).not(".crosstalk-input-bound").each(function(r,a){o(n,a)})})}function o(e,n){var r=c(n).find("script[type='application/json'][data-for='"+n.id.replace(/([!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~])/g,"\\$1")+"']"),a=JSON.parse(r[0].innerText),l=e.factory(n,a);c(n).data("crosstalk-instance",l),c(n).addClass("crosstalk-input-bound")}if(f.Shiny){var i=new f.Shiny.InputBinding,t=f.jQuery;t.extend(i,{find:function(e){return t(e).find(".crosstalk-input")},initialize:function(e){var n,r;t(e).hasClass("crosstalk-input-bound")||(r=c(n=e),Object.keys(h).forEach(function(a){r.hasClass(a)&&!r.hasClass("crosstalk-input-bound")&&o(h[a],n)}))},getId:function(e){return e.id},getValue:function(e){},setValue:function(e,n){},receiveMessage:function(e,n){},subscribe:function(e,n){t(e).data("crosstalk-instance").resume()},unsubscribe:function(e){t(e).data("crosstalk-instance").suspend()}}),f.Shiny.inputBindings.register(i,"crosstalk.inputBinding")}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],7:[function(d,p,s){(function(f){"use strict";var c=function(o){{if(o&&o.__esModule)return o;var i={};if(o!=null)for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(i[t]=o[t]);return i.default=o,i}}(d("./input")),h=d("./filter"),u=f.jQuery;c.register({className:"crosstalk-input-checkboxgroup",factory:function(o,i){var t=new h.FilterHandle(i.group),e=void 0,n=u(o);return n.on("change","input[type='checkbox']",function(){var r=n.find("input[type='checkbox']:checked");if(r.length===0)e=null,t.clear();else{var a={};r.each(function(){i.map[this.value].forEach(function(v){a[v]=!0})});var l=Object.keys(a);l.sort(),e=l,t.set(l)}}),{suspend:function(){t.clear()},resume:function(){e&&t.set(e)}}}})}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./filter":2,"./input":6}],8:[function(d,p,s){(function(f){"use strict";var c=o(d("./input")),h=o(d("./util")),u=d("./filter");function o(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}var i=f.jQuery;c.register({className:"crosstalk-input-select",factory:function(t,e){var n=h.dataframeToD3(e.items),r={options:[{value:"",label:"(All)"}].concat(n),valueField:"value",labelField:"label",searchField:"label"},a=i(t).find("select")[0],l=i(a).selectize(r)[0].selectize,v=new u.FilterHandle(e.group),y=void 0;return l.on("change",function(){if(l.items.length===0)y=null,v.clear();else{var m={};l.items.forEach(function(w){e.map[w].forEach(function(O){m[O]=!0})});var _=Object.keys(m);_.sort(),y=_,v.set(_)}}),{suspend:function(){v.clear()},resume:function(){y&&v.set(y)}}}})}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./filter":2,"./input":6,"./util":11}],9:[function(d,p,s){(function(f){"use strict";var c=function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(r,a){var l=[],v=!0,y=!1,m=void 0;try{for(var _,w=r[Symbol.iterator]();!(v=(_=w.next()).done)&&(l.push(_.value),!a||l.length!==a);v=!0);}catch(O){y=!0,m=O}finally{try{!v&&w.return&&w.return()}finally{if(y)throw m}}return l}(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")},h=function(e){{if(e&&e.__esModule)return e;var n={};if(e!=null)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n.default=e,n}}(d("./input")),u=d("./filter"),o=f.jQuery,i=f.strftime;function t(e,n){for(var r=e.toString();r.length<n;)r="0"+r;return r}h.register({className:"crosstalk-input-slider",factory:function(e,n){var r=new u.FilterHandle(n.group),a={},l=o(e).find("input"),v=l.data("data-type"),y=l.data("time-format"),m=l.data("round"),_=void 0;if(v==="date")_=i.utc(),a.prettify=function(g){return _(y,new Date(g))};else if(v==="datetime"){var w=l.data("timezone");_=w?i.timezone(w):i,a.prettify=function(g){return _(y,new Date(g))}}else v==="number"&&m!==void 0&&(a.prettify=function(g){var b=Math.pow(10,m);return Math.round(g*b)/b});function O(){var g=l.data("ionRangeSlider").result,b=void 0,j=l.data("data-type");return b=j==="date"?function(k){return(S=new Date(+k))instanceof Date?S.getUTCFullYear()+"-"+t(S.getUTCMonth()+1,2)+"-"+t(S.getUTCDate(),2):null;var S}:j==="datetime"?function(k){return+k/1e3}:function(k){return+k},l.data("ionRangeSlider").options.type==="double"?[b(g.from),b(g.to)]:b(g.from)}l.ionRangeSlider(a);var P=null;return l.on("change.crosstalkSliderInput",function(g){if(!l.data("updating")&&!l.data("animating")){for(var b=O(),j=c(b,2),k=j[0],S=j[1],x=[],C=0;C<n.values.length;C++){var E=n.values[C];k<=E&&E<=S&&x.push(n.keys[C])}x.sort(),r.set(x),P=x}}),{suspend:function(){r.clear()},resume:function(){P&&r.set(P)}}}})}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./filter":2,"./input":6}],10:[function(d,p,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.SelectionHandle=void 0;var f=function(){function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),c=o(d("./events")),h=o(d("./group")),u=function(i){{if(i&&i.__esModule)return i;var t={};if(i!=null)for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t.default=i,t}}(d("./util"));function o(i){return i&&i.__esModule?i:{default:i}}s.SelectionHandle=function(){function i(){var t=0<arguments.length&&arguments[0]!==void 0?arguments[0]:null,e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null;(function(n,r){if(!(n instanceof r))throw new TypeError("Cannot call a class as a function")})(this,i),this._eventRelay=new c.default,this._emitter=new u.SubscriptionTracker(this._eventRelay),this._group=null,this._var=null,this._varOnChangeSub=null,this._extraInfo=u.extend({sender:this},e),this.setGroup(t)}return f(i,[{key:"setGroup",value:function(t){var e=this;if(this._group!==t&&(this._group||t)&&(this._var&&(this._var.off("change",this._varOnChangeSub),this._var=null,this._varOnChangeSub=null),this._group=t)){this._var=(0,h.default)(t).var("selection");var n=this._var.on("change",function(r){e._eventRelay.trigger("change",r,e)});this._varOnChangeSub=n}}},{key:"_mergeExtraInfo",value:function(t){return u.extend({},this._extraInfo?this._extraInfo:null,t||null)}},{key:"set",value:function(t,e){this._var&&this._var.set(t,this._mergeExtraInfo(e))}},{key:"clear",value:function(t){this._var&&this.set(void 0,this._mergeExtraInfo(t))}},{key:"on",value:function(t,e){return this._emitter.on(t,e)}},{key:"off",value:function(t,e){return this._emitter.off(t,e)}},{key:"close",value:function(){this._emitter.removeAllListeners(),this.setGroup(null)}},{key:"value",get:function(){return this._var?this._var.get():null}}]),i}()},{"./events":1,"./group":4,"./util":11}],11:[function(d,p,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var f=function(){function u(o,i){for(var t=0;t<i.length;t++){var e=i[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(o,e.key,e)}}return function(o,i,t){return i&&u(o.prototype,i),t&&u(o,t),o}}(),c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u};function h(u){for(var o=1;o<u.length;o++)if(u[o]<=u[o-1])throw new Error("List is not sorted or contains duplicate")}s.extend=function(u){for(var o=arguments.length,i=Array(1<o?o-1:0),t=1;t<o;t++)i[t-1]=arguments[t];for(var e=0;e<i.length;e++){var n=i[e];if(n!=null)for(var r in n)n.hasOwnProperty(r)&&(u[r]=n[r])}return u},s.checkSorted=h,s.diffSortedLists=function(u,o){var i=0,t=0;u||(u=[]),o||(o=[]);var e=[],n=[];for(h(u),h(o);i<u.length&&t<o.length;)u[i]===o[t]?(i++,t++):u[i]<o[t]?e.push(u[i++]):n.push(o[t++]);return i<u.length&&(e=e.concat(u.slice(i))),t<o.length&&(n=n.concat(o.slice(t))),{removed:e,added:n}},s.dataframeToD3=function(u){var o=[],i=void 0;for(var t in u){if(u.hasOwnProperty(t)&&o.push(t),c(u[t])!=="object"||u[t].length===void 0)throw new Error("All fields must be arrays");if(i!==void 0&&i!==u[t].length)throw new Error("All fields must be arrays of the same length");i=u[t].length}for(var e=[],n=void 0,r=0;r<i;r++){n={};for(var a=0;a<o.length;a++)n[o[a]]=u[o[a]][r];e.push(n)}return e},s.SubscriptionTracker=function(){function u(o){(function(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")})(this,u),this._emitter=o,this._subs={}}return f(u,[{key:"on",value:function(o,i){var t=this._emitter.on(o,i);return this._subs[t]=o,t}},{key:"off",value:function(o,i){var t=this._emitter.off(o,i);return t&&delete this._subs[t],t}},{key:"removeAllListeners",value:function(){var o=this,i=this._subs;this._subs={},Object.keys(i).forEach(function(t){o._emitter.off(i[t],t)})}}]),u}()},{}],12:[function(d,p,s){(function(f){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var c,h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(n,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(n,l.key,l)}}return function(n,r,a){return r&&e(n.prototype,r),a&&e(n,a),n}}(),o=d("./events"),i=(c=o)&&c.__esModule?c:{default:c},t=function(){function e(n,r,a){(function(l,v){if(!(l instanceof v))throw new TypeError("Cannot call a class as a function")})(this,e),this._group=n,this._name=r,this._value=a,this._events=new i.default}return u(e,[{key:"get",value:function(){return this._value}},{key:"set",value:function(n,r){if(this._value!==n){var a=this._value;this._value=n;var l={};if(r&&(r===void 0?"undefined":h(r))==="object")for(var v in r)r.hasOwnProperty(v)&&(l[v]=r[v]);l.oldValue=a,l.value=n,this._events.trigger("change",l,this),f.Shiny&&f.Shiny.onInputChange&&f.Shiny.onInputChange(".clientValue-"+(this._group.name!==null?this._group.name+"-":"")+this._name,n===void 0?null:n)}}},{key:"on",value:function(n,r){return this._events.on(n,r)}},{key:"off",value:function(n,r){return this._events.off(n,r)}}]),e}();s.default=t}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./events":1}]},{},[5]);
